doctype html
html
  head
    title= title
    link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css', integrity='sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T', crossorigin='anonymous')
    script(src='https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js', integrity='sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM', crossorigin='anonymous')
    link(rel='stylesheet', href='/stylesheets/style.css')
  body
    nav.navbar.navbar-expand-lg.navbar-light.bg-light
      a.navbar-brand(href='/users') Movie.Me
      button.navbar-toggler(type='button', data-toggle='collapse', data-target='#navbarNav', aria-controls='navbarNav', aria-expanded='false', aria-label='Toggle navigation')
        span.navbar-toggler-icon
      div.collapse.navbar-collapse#navbarNav
        ul.navbar-nav.ml-auto
          li.nav-item.active
            a.nav-link(href='/movies') Find Movies
          li.nav-item
            form(action='/logout', method='POST')
              button.btn.btn-link(type='submit') Sign Out
    div.container-fluid.my-4
      div.favorite-header
        h3 Favorite Movies (#{likedMovies.length}/5)
        button.btn.btn-primary#add-movie-button(onclick='toggleAddMovieForm()') Add Movie
      if errorMessage
        div.alert.alert-danger= errorMessage
      form#add-movie-form(method='POST', action=`/users/add-movie`, style='display: none;')
        div.form-group
          label(for='movieName') Movie Name
          input.form-control(type='text', id='movieName', name='movieName')
        button.btn.btn-success(type='submit') Add
      if user && user.likedMovies && user.likedMovies.length > 0
        .row
          each movie, index in user.likedMovies
            .col-lg-2.col-md-3.col-sm-4.mb-3
              .card
                img.card-img-top(src='https://via.placeholder.com/200x300?text=Movie+Poster', alt='Movie Poster', style='max-height: 150px;')
                .card-body
                  div.d-flex.justify-content-between
                    h5.card-title.favorite-size(class=movie.length > 30 ? 'favorite-title' : '')= movie
                    form(method='POST', action=`/users/remove-movie`)
                      input(type='hidden', name='movieName', value=`${movie}`)
                      button.close(data-movie='#{movie}', aria-label='Close', type='submit') &times;

      else
        p You haven't added any favorite movies yet.
    div.container-recommended
      if user && user.recommendedMovies && user.recommendedMovies.length > 0
        div.recommended-header
          h3 Next Watches (#{user.recommendedMovies.length})
        .row
          each movie in user.recommendedMovies
            .col-lg-2.col-md-3.col-sm-4.mb-3(id=`movie-${index}`)
              .card
                img.card-img-top(src='https://via.placeholder.com/200x300?text=Movie+Poster', alt='Movie Poster', style='max-height: 200px;')
                .card-body
                  h5.card-title.text-truncate= movie.title
                  p.card-text.text-muted.text-truncate= `${movie.year} - ${movie.genre}`
                  p.movie-description= movie.description
                  h6 Places to watch:
                  ul.list-group.list-group-flush
                    each location in movie.watchLocations
                      li.list-group-item(style='color: white;')= location
                  form.remove-form(method='POST', action=`/users/no-interest`)
                    input(type='hidden', name='title', value=`${movie.title}`)
                    button.btn.btn-danger(type='submit') Remove

script(src='/javascripts/addmovie.js')